<html>
  <head>
    <title>Pebble Rorschach config</title>

    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <script type="text/javascript">
      $(function() {
        $.urlParam = function(name){
          var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
          if (!results) { return 0; }
          return results[1] || 0;
        }

        var settings = JSON.parse(decodeURIComponent($.urlParam('settings')));

        console.log(settings);

        $.each(settings, function(name, value) {
          $('[name=' + name + ']').val(value);
        });

        $('form#settings').submit(function(event) {
          var settings = {};
          $.each($('form').serializeArray(), function() {
            settings[this.name] = parseInt(this.value);
          });

          var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(settings));
          console.log(location);
          document.location = location;
          event.preventDefault();
        });
      });
    </script>
  </head>
  <body>
    <form id="settings">
      <select name="bgcolor">
        <option value="-1">Auto</option>
        <option value="0">Black</option>
        <option value="1">White</option>
      </select>

      <input type="submit" value="Submit" />
    </form>

  </body>
</html>
